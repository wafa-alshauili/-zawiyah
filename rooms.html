<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Arabic+Poetry:opsz,wght@16..72,400;16..72,700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<nav class="navbar">
	<div class="corner-logos">
		<img class="logo-ministry" src="https://i.ibb.co/HfwV7QB5/ministerylogo1-1.png" alt="Ø´Ø¹Ø§Ø± ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© ÙˆØ§Ù„ØªØ¹Ù„ÙŠÙ… Ø³Ù„Ø·Ù†Ø© Ø¹Ù…Ø§Ù†">
	</div>
</nav>

<main class="container">
			<div class="site-title-bar" style="text-align:center; margin: 40px auto 0 auto;">
				<span class="site-title">Ø²Ø§ÙˆÙŠØ©</span>
					<div style="position:relative;">
												<button id="menu-toggle" style="display:none; background:none; border:none; position:absolute; left:18px; top:18px; z-index:1100; cursor:pointer;">
													  <span style="font-size:1.5em; color:#1b3767;">&#9776;</span>
												</button>
												<ul class="nav-links" id="nav-links" style="display:flex; justify-content:center; gap:32px; list-style:none; margin:28px auto 0 auto; padding:0; background:rgba(27,55,103,0.12); border-radius:16px; box-shadow:0 2px 12px rgba(27,55,103,0.08);">
													<li><a href="index.html" style="font-size:1.2em; font-family:'Times New Roman', Times, serif; color:#1b3767; font-weight:bold; padding:10px 24px; border-radius:8px;">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
													<li><a href="reservations.html" style="font-size:1.2em; font-family:'Times New Roman', Times, serif; color:#1b3767; font-weight:bold; padding:10px 24px; border-radius:8px;">Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</a></li>
													<li><a href="rooms.html" class="active" style="font-size:1.2em; font-family:'Times New Roman', Times, serif; color:#1b3767; font-weight:bold; padding:10px 24px; border-radius:8px;">Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</a></li>
												</ul>
					</div>
			</div>

<main class="container">
	<h1 class="main-title">Ø²Ø§ÙˆÙŠØ©</h1>
<h2>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</h2>

<form id="room-form">
<input type="text" id="room-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø©" required>
<button type="submit">â• Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø©</button>
<button type="button" onclick="addMissingRooms()" style="background: #17a2b8; color: white; margin-right: 10px;">ğŸ†• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</button>
<button type="button" onclick="restoreRoomsBackup()" style="background: #ffc107; color: #212529; margin-right: 10px;">ğŸ”„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</button>
<button type="button" onclick="resetToDefault()" style="background: #6c757d; color: white; margin-right: 10px;">âš™ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
</form>

<ul id="room-list"></ul>

<!-- Ù†Ø§ÙØ°Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¹Ø© -->
<div id="room-stats-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000;">
  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h3 id="room-stats-title" style="color: #1b3767; margin: 0;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¹Ø©</h3>
      <button onclick="closeRoomStatsModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">Ã—</button>
    </div>
    
    <div id="room-stats-content" style="text-align: center;">
      <div style="margin: 20px 0;">
        <div style="color: #666;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</div>
      </div>
    </div>
    
    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
      <button onclick="printRoomStats()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
        ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©
      </button>
      <button onclick="exportRoomStats()" style="background: #17a2b8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
        ğŸ’¾ ØªØµØ¯ÙŠØ±
      </button>
    </div>
  </div>
</div>
</main>

<script src="script.js"></script>
<script>
// Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
let rooms = [];

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù…Ù† localStorage
function loadRooms() {
  try {
    const savedRooms = localStorage.getItem('school_rooms');
    if (savedRooms) {
      rooms = JSON.parse(savedRooms);
      console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù…Ù† localStorage:', rooms);
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
      checkAndAddNewRooms();
    } else {
      console.log('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø§Ø¹Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©ØŒ Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...');
      // Ù‚Ø§Ø¹Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
      rooms = ['Ø§Ù„Ù…Ø®ØªØ¨Ø±', 'Ù‚Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨', 'Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
      saveRooms();
    }
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª:', error);
    // ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    rooms = ['Ø§Ù„Ù…Ø®ØªØ¨Ø±', 'Ù‚Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨', 'Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
    saveRooms();
  }
  
  // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù‚Ø§Ø¹Ø§Øª
  if (!Array.isArray(rooms) || rooms.length === 0) {
    console.log('ØªØµØ­ÙŠØ­: Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©');
    rooms = ['Ø§Ù„Ù…Ø®ØªØ¨Ø±', 'Ù‚Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨', 'Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
    saveRooms();
  }
  
  displayRooms();
}

// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§
function checkAndAddNewRooms() {
  const newRooms = ['Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
  let added = false;
  
  newRooms.forEach(room => {
    if (!rooms.includes(room)) {
      rooms.push(room);
      added = true;
      console.log(`ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${room}`);
    }
  });
  
  if (added) {
    saveRooms();
    alert('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©: Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©ØŒ ØºØ±ÙØ© ØµÙÙŠØ©');
  }
}

// Ø­ÙØ¸ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª ÙÙŠ localStorage
function saveRooms() {
  try {
    // Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    localStorage.setItem('school_rooms', JSON.stringify(rooms));
    // Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
    localStorage.setItem('school_rooms_backup', JSON.stringify(rooms));
    // Ø­ÙØ¸ ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
    localStorage.setItem('school_rooms_last_update', new Date().toISOString());
    console.log('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª:', rooms);
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª:', error);
    alert('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø§Ø­Ø© ÙƒØ§ÙÙŠØ© ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­.');
  }
}

// Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª
function displayRooms() {
  const roomList = document.getElementById('room-list');
  roomList.innerHTML = '';
  
  if (rooms.length === 0) {
    roomList.innerHTML = '<li style="text-align: center; color: #666; padding: 20px; font-style: italic;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø§Ø¹Ø§Øª Ù…Ø¶Ø§ÙØ©</li>';
    return;
  }
  
  rooms.forEach((room, index) => {
    const li = document.createElement('li');
    li.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0;">
        <div>
          <strong style="color: #1b3767; font-size: 1.1em;">${index + 1}. ${room}</strong>
          <div style="color: #666; font-size: 0.9em; margin-top: 5px;">ğŸ“ Ù‚Ø§Ø¹Ø© Ù…ØªØ§Ø­Ø© Ù„Ù„Ø­Ø¬Ø²</div>
        </div>
        <div style="display: flex; gap: 8px;">
          <button onclick="showRoomStats('${room}')" 
                  style="background: linear-gradient(135deg, #007bff, #0056b3); color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9em; transition: transform 0.2s;">
            ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
          </button>
          <button onclick="deleteRoom(${index})" 
                  style="background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 0.9em;">
            ğŸ—‘ï¸ Ø­Ø°Ù
          </button>
        </div>
      </div>
    `;
    roomList.appendChild(li);
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
  const statsDiv = document.createElement('div');
  statsDiv.style.cssText = `
    background: #1b3767; color: white; padding: 15px; border-radius: 8px; 
    margin: 20px 0; text-align: center;
  `;
  statsDiv.innerHTML = `
    <h3 style="margin: 0 0 15px 0;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¹Ø§Øª</h3>
    <p style="margin: 5px 0; font-size: 1.1em;">
      Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª: <strong>${rooms.length}</strong>
    </p>
    <button onclick="showDataStatus()" style="background: rgba(255,255,255,0.2); color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px; font-size: 0.9em;">
      ğŸ“‹ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    </button>
  `;
  roomList.appendChild(statsDiv);
}

// Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©
function addRoom(event) {
  event.preventDefault();
  const roomNameInput = document.getElementById('room-name');
  const roomName = roomNameInput.value.trim();
  
  if (!roomName) {
    alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ø¹Ø©');
    return;
  }
  
  if (rooms.includes(roomName)) {
    alert('âŒ Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¹Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„');
    return;
  }
  
  rooms.push(roomName);
  saveRooms();
  displayRooms();
  roomNameInput.value = '';
  
  alert(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø§Ø¹Ø© "${roomName}" Ø¨Ù†Ø¬Ø§Ø­`);
}

// Ø­Ø°Ù Ù‚Ø§Ø¹Ø©
function deleteRoom(index) {
  const roomName = rooms[index];
  if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ø¹Ø© "${roomName}"ØŸ`)) {
    rooms.splice(index, 1);
    saveRooms();
    displayRooms();
    alert(`âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ø¹Ø© "${roomName}" Ø¨Ù†Ø¬Ø§Ø­`);
  }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
  loadRooms();
  document.getElementById('room-form').addEventListener('submit', addRoom);
});

// Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙŠØ¯ÙˆÙŠØ§Ù‹
function addMissingRooms() {
  const newRooms = ['Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
  let addedRooms = [];
  
  newRooms.forEach(room => {
    if (!rooms.includes(room)) {
      rooms.push(room);
      addedRooms.push(room);
    }
  });
  
  if (addedRooms.length > 0) {
    saveRooms();
    displayRooms();
    alert(`âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:\n${addedRooms.join('\n')}`);
  } else {
    alert('â„¹ï¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¨Ø§Ù„ÙØ¹Ù„');
  }
}

// Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©
function restoreRoomsBackup() {
  try {
    const backupRooms = localStorage.getItem('school_rooms_backup');
    if (backupRooms) {
      const parsedBackup = JSON.parse(backupRooms);
      if (Array.isArray(parsedBackup) && parsedBackup.length > 0) {
        rooms = parsedBackup;
        saveRooms();
        displayRooms();
        alert(`âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© ${rooms.length} Ù‚Ø§Ø¹Ø© Ù…Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©`);
      } else {
        alert('âš ï¸ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙØ§Ø±ØºØ© Ø£Ùˆ ØªØ§Ù„ÙØ©');
      }
    } else {
      alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…ØªØ§Ø­Ø©');
    }
  } catch (error) {
    console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©:', error);
    alert('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
  }
}

// Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù„Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
function resetToDefault() {
  if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ\nØ³ÙŠØªÙ… ÙÙ‚Ø¯Ø§Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©.')) {
    rooms = ['Ø§Ù„Ù…Ø®ØªØ¨Ø±', 'Ù‚Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ø³ÙˆØ¨', 'Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©', 'Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©', 'ØºØ±ÙØ© ØµÙÙŠØ©'];
    saveRooms();
    displayRooms();
    alert('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (6 Ù‚Ø§Ø¹Ø§Øª)');
  }
}

// Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function showDataStatus() {
  const lastUpdate = localStorage.getItem('school_rooms_last_update');
  const hasBackup = localStorage.getItem('school_rooms_backup');
  const currentRooms = rooms.length;
  
  let message = `ğŸ“Š Ø­Ø§Ù„Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø§Ø¹Ø§Øª:\n`;
  message += `â€¢ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${currentRooms}\n`;
  message += `â€¢ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: ${lastUpdate ? new Date(lastUpdate).toLocaleString('ar-SA') : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\n`;
  message += `â€¢ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: ${hasBackup ? 'Ù…ØªÙˆÙØ±Ø© âœ…' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±Ø© âŒ'}`;
  
  alert(message);
}

// Ø¯ÙˆØ§Ù„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù‚Ø§Ø¹Ø©
function showRoomStats(roomName) {
  const modal = document.getElementById('room-stats-modal');
  const title = document.getElementById('room-stats-title');
  const content = document.getElementById('room-stats-content');
  
  title.textContent = `ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© ${roomName}`;
  content.innerHTML = '<div style="color: #666;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</div>';
  modal.style.display = 'block';
  
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
  setTimeout(() => {
    const stats = calculateRoomStats(roomName);
    displayRoomStatsContent(stats, roomName);
  }, 500);
}

function calculateRoomStats(roomName) {
  // Ø¬Ù„Ø¨ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ù…Ù† localStorage
  const reservations = JSON.parse(localStorage.getItem('school_reservations') || '[]');
  const roomReservations = reservations.filter(res => res.room === roomName);
  
  if (roomReservations.length === 0) {
    return {
      totalReservations: 0,
      topTeachers: [],
      topSubjects: [],
      busyDays: [],
      weeklyActivity: {}
    };
  }
  
  // Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø­Ø¬Ø²Ø§Ù‹
  const teacherCounts = {};
  roomReservations.forEach(res => {
    teacherCounts[res.teacher] = (teacherCounts[res.teacher] || 0) + 1;
  });
  const topTeachers = Object.entries(teacherCounts)
    .sort(([,a], [,b]) => b - a)
    .slice(0, 5);
  
  // Ø£ÙƒØ«Ø± Ø§Ù„ÙØµÙˆÙ„ Ù†Ø´Ø§Ø·Ø§Ù‹
  const subjectCounts = {};
  roomReservations.forEach(res => {
    subjectCounts[res.subject] = (subjectCounts[res.subject] || 0) + 1;
  });
  const topSubjects = Object.entries(subjectCounts)
    .sort(([,a], [,b]) => b - a)
    .slice(0, 5);
  
  // Ø£ÙƒØ«Ø± Ø§Ù„Ø£ÙŠØ§Ù… Ù†Ø´Ø§Ø·Ø§Ù‹
  const dayCounts = {};
  const dayNames = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³'];
  roomReservations.forEach(res => {
    const dayName = dayNames[res.day] || `Ø§Ù„ÙŠÙˆÙ… ${res.day + 1}`;
    dayCounts[dayName] = (dayCounts[dayName] || 0) + 1;
  });
  const busyDays = Object.entries(dayCounts)
    .sort(([,a], [,b]) => b - a)
    .slice(0, 5);
  
  return {
    totalReservations: roomReservations.length,
    topTeachers,
    topSubjects,
    busyDays,
    weeklyActivity: dayCounts
  };
}

function displayRoomStatsContent(stats, roomName) {
  const content = document.getElementById('room-stats-content');
  
  if (stats.totalReservations === 0) {
    content.innerHTML = `
      <div style="text-align: center; padding: 40px;">
        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“‹</div>
        <h3 style="color: #666;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù‚Ø§Ø¹Ø©</h3>
        <p style="color: #999;">Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ø­Ø¬ÙˆØ²Ø§Øª Ù„Ù‚Ø§Ø¹Ø© ${roomName} Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
      </div>
    `;
    return;
  }
  
  content.innerHTML = `
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
      
      <!-- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª -->
      <div style="background: linear-gradient(135deg, #1b3767, #2d4a7a); color: white; padding: 20px; border-radius: 8px; text-align: center;">
        <div style="font-size: 36px; margin-bottom: 10px;">ğŸ“…</div>
        <h4 style="margin: 0 0 10px 0;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h4>
        <div style="font-size: 28px; font-weight: bold;">${stats.totalReservations}</div>
      </div>
      
      <!-- Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø­Ø¬Ø²Ø§Ù‹ -->
      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border: 2px solid #e9ecef;">
        <h4 style="color: #1b3767; margin: 0 0 15px 0; text-align: center;">ğŸ‘©â€ğŸ« Ø£ÙƒØ«Ø± Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª Ø­Ø¬Ø²Ø§Ù‹</h4>
        ${stats.topTeachers.length > 0 ? 
          stats.topTeachers.map(([teacher, count], index) => `
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
              <span style="font-weight: ${index === 0 ? 'bold' : 'normal'}; color: ${index === 0 ? '#1b3767' : '#666'};">
                ${index + 1}. ${teacher}
              </span>
              <span style="background: ${index === 0 ? '#1b3767' : '#6c757d'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.9em;">
                ${count}
              </span>
            </div>
          `).join('') : 
          '<div style="text-align: center; color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>'
        }
      </div>
      
      <!-- Ø£ÙƒØ«Ø± Ø§Ù„ÙØµÙˆÙ„ Ù†Ø´Ø§Ø·Ø§Ù‹ -->
      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border: 2px solid #e9ecef;">
        <h4 style="color: #1b3767; margin: 0 0 15px 0; text-align: center;">ğŸ“š Ø£ÙƒØ«Ø± Ø§Ù„ÙØµÙˆÙ„ Ù†Ø´Ø§Ø·Ø§Ù‹</h4>
        ${stats.topSubjects.length > 0 ? 
          stats.topSubjects.map(([subject, count], index) => `
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
              <span style="font-weight: ${index === 0 ? 'bold' : 'normal'}; color: ${index === 0 ? '#1b3767' : '#666'};">
                ${index + 1}. ${subject}
              </span>
              <span style="background: ${index === 0 ? '#28a745' : '#6c757d'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.9em;">
                ${count}
              </span>
            </div>
          `).join('') : 
          '<div style="text-align: center; color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>'
        }
      </div>
      
      <!-- Ø£ÙƒØ«Ø± Ø§Ù„Ø£ÙŠØ§Ù… Ù†Ø´Ø§Ø·Ø§Ù‹ -->
      <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; border: 2px solid #e9ecef;">
        <h4 style="color: #1b3767; margin: 0 0 15px 0; text-align: center;">ğŸ“Š Ø£ÙƒØ«Ø± Ø§Ù„Ø£ÙŠØ§Ù… Ù†Ø´Ø§Ø·Ø§Ù‹</h4>
        ${stats.busyDays.length > 0 ? 
          stats.busyDays.map(([day, count], index) => `
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #e9ecef;">
              <span style="font-weight: ${index === 0 ? 'bold' : 'normal'}; color: ${index === 0 ? '#1b3767' : '#666'};">
                ${index + 1}. ${day}
              </span>
              <span style="background: ${index === 0 ? '#17a2b8' : '#6c757d'}; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.9em;">
                ${count}
              </span>
            </div>
          `).join('') : 
          '<div style="text-align: center; color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>'
        }
      </div>
      
    </div>
    
    <!-- Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø£ÙŠØ§Ù… -->
    <div style="margin-top: 30px; background: white; padding: 20px; border-radius: 8px; border: 2px solid #e9ecef;">
      <h4 style="color: #1b3767; text-align: center; margin-bottom: 20px;">ğŸ“ˆ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£ÙŠØ§Ù…</h4>
      <canvas id="room-days-chart" width="400" height="200"></canvas>
    </div>
  `;
  
  // Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
  setTimeout(() => createRoomDaysChart(stats.weeklyActivity), 100);
}

function createRoomDaysChart(weeklyActivity) {
  const canvas = document.getElementById('room-days-chart');
  if (!canvas) return;
  
  // ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ù† ÙˆÙØ¬Ø¯
  if (window.roomDaysChart) {
    window.roomDaysChart.destroy();
  }
  
  const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³'];
  const data = days.map(day => weeklyActivity[day] || 0);
  
  const ctx = canvas.getContext('2d');
  window.roomDaysChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: days,
      datasets: [{
        label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª',
        data: data,
        backgroundColor: [
          '#1b3767',
          '#2d4a7a',
          '#3e5d8d',
          '#4f70a0',
          '#6083b3'
        ],
        borderColor: '#1b3767',
        borderWidth: 1,
        borderRadius: 4
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            stepSize: 1,
            font: {
              family: 'Arial'
            }
          },
          grid: {
            color: '#e9ecef'
          }
        },
        x: {
          ticks: {
            font: {
              family: 'Arial',
              size: 12
            }
          },
          grid: {
            display: false
          }
        }
      },
      animation: {
        duration: 1000,
        easing: 'easeOutQuart'
      }
    }
  });
}

function closeRoomStatsModal() {
  document.getElementById('room-stats-modal').style.display = 'none';
}

function printRoomStats() {
  const roomName = document.getElementById('room-stats-title').textContent.replace('ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© ', '');
  const content = document.getElementById('room-stats-content').innerHTML;
  
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <!DOCTYPE html>
    <html dir="rtl">
    <head>
      <meta charset="UTF-8">
      <title>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© ${roomName}</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
        h1 { color: #1b3767; text-align: center; }
        .no-print { display: none; }
        @media print { .no-print { display: none !important; } }
      </style>
    </head>
    <body>
      <h1>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© ${roomName}</h1>
      <div>${content}</div>
      <p style="text-align: center; margin-top: 30px; color: #666; font-size: 0.9em;">
        Ø·ÙØ¨Ø¹Øª Ù…Ù† Ù†Ø¸Ø§Ù… Ø²Ø§ÙˆÙŠØ© - ${new Date().toLocaleDateString('ar-SA')}
      </p>
    </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

function exportRoomStats() {
  const roomName = document.getElementById('room-stats-title').textContent.replace('ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© ', '');
  const stats = calculateRoomStats(roomName);
  
  const exportData = {
    roomName: roomName,
    exportDate: new Date().toISOString(),
    totalReservations: stats.totalReservations,
    topTeachers: stats.topTeachers,
    topSubjects: stats.topSubjects,
    busyDays: stats.busyDays,
    weeklyActivity: stats.weeklyActivity
  };
  
  const dataStr = JSON.stringify(exportData, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
  
  const exportFileDefaultName = `room-stats-${roomName}-${new Date().toISOString().split('T')[0]}.json`;
  
  const linkElement = document.createElement('a');
  linkElement.setAttribute('href', dataUri);
  linkElement.setAttribute('download', exportFileDefaultName);
  linkElement.click();
  
  alert(`âœ… ØªÙ… ØªØµØ¯ÙŠØ± Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø§Ø¹Ø© "${roomName}" Ø¨Ù†Ø¬Ø§Ø­`);
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØªØ«Ø¨ÙŠØª Ù…ÙˆÙ‚Ø¹Ù‡ ÙÙŠ Ø£Ø¹Ù„Ù‰ ÙŠØ³Ø§Ø± Ø§Ù„ØµÙØ­Ø©
function toggleMenuButton() {
	var btn = document.getElementById('menu-toggle');
	var nav = document.getElementById('nav-links');
	btn.style.position = 'fixed';
	btn.style.left = '18px';
	btn.style.top = '18px';
	btn.style.zIndex = '1100';
	if(window.innerWidth <= 768) {
		btn.style.display = 'block';
		nav.style.position = 'absolute';
		nav.style.top = '60px';
		nav.style.left = '50%';
		nav.style.transform = 'translateX(-50%)';
		nav.style.width = '90vw';
		nav.style.maxWidth = '320px';
		nav.style.background = '#fff';
		nav.style.boxShadow = '0 2px 12px #1b376722';
		nav.style.borderRadius = '12px';
		nav.style.zIndex = '1000';
	} else {
		btn.style.display = 'none';
		nav.style.position = '';
		nav.style.top = '';
		nav.style.left = '';
		nav.style.transform = '';
		nav.style.width = '';
		nav.style.maxWidth = '';
		nav.style.background = 'rgba(27,55,103,0.12)';
		nav.style.boxShadow = '0 2px 12px rgba(27,55,103,0.08)';
		nav.style.borderRadius = '16px';
		nav.style.zIndex = '';
		nav.classList.remove('show');
	}
}
window.addEventListener('resize', toggleMenuButton);
window.addEventListener('DOMContentLoaded', toggleMenuButton);
</script>
</body>
<footer style="background:rgba(27,55,103,0.08); color:#1b3767; text-align:center; padding:18px 0; font-size:1.1em; font-family:'Times New Roman', Times, serif; margin-top:40px; border-radius:0 0 16px 16px;">
	Ù…ØµÙ…Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ : ÙˆÙØ§Ø¡ Ø§Ù„Ø´Ø¹ÙŠÙ„ÙŠØ© &mdash; Ù…Ø¹Ù„Ù…Ø© ØªÙ‚Ù†ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
</footer>
</html>
